
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Fourier Interpolation Module &#8212; pysofi 0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reconstruction Options" href="reconstruction.html" />
    <link rel="prev" title="The “PysofiData()” class" href="data_class.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reconstruction.html" title="Reconstruction Options"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="data_class.html" title="The “PysofiData()” class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysofi 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="manual.html" accesskey="U">PySOFI Reference Manual</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fourier-interpolation-module">
<h1>Fourier Interpolation Module<a class="headerlink" href="#fourier-interpolation-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pysofi.finterp">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-pysofi.finterp" title="Permalink to this headline">¶</a></h2>
<p>This module performs fourier interpolation on a single image
or a image stack (tiff file). Interpolated image (stack) can be
saved into a new tiff file or return as a numpy array.</p>
<p>Fourier interpolation was implemented with transformation matrix
operation, where the Fourier transformation matrix was constructed
with the original matrix size without interpolation grids, and the
inverse Fourier transformation matrix encodes the extra interpolation
position coordinates.</p>
<p>Adapted from <a class="reference external" href="https://github.com/xiyuyi/xy_fInterp_forTIFF">https://github.com/xiyuyi/xy_fInterp_forTIFF</a>.</p>
<dl class="function">
<dt id="pysofi.finterp.fourier_interp_array">
<code class="sig-prename descclassname">pysofi.finterp.</code><code class="sig-name descname">fourier_interp_array</code><span class="sig-paren">(</span><em class="sig-param">im</em>, <em class="sig-param">interp_num_lst</em><span class="sig-paren">)</span><a class="headerlink" href="#pysofi.finterp.fourier_interp_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs fourier interpolation on an image array with a list of
interpolation factors.</p>
</dd></dl>

<dl class="function">
<dt id="pysofi.finterp.fourier_interp_tiff">
<code class="sig-prename descclassname">pysofi.finterp.</code><code class="sig-name descname">fourier_interp_tiff</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">filename</em>, <em class="sig-param">interp_num_lst</em>, <em class="sig-param">frames=[]</em>, <em class="sig-param">save_option=True</em>, <em class="sig-param">return_option=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysofi.finterp.fourier_interp_tiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs fourier interpolation on a tiff image (stack) with a list of
interpolation factors (the number of pixels to be interpolated between
two adjacent pixels).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – The path to the tiff file.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The filename of the tiff file without ‘.tif’.</p></li>
<li><p><strong>interp_num_lst</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – A list of interpolation factors.</p></li>
<li><p><strong>frames</strong> (<em>list of int</em>) – The start and end frame number.</p></li>
<li><p><strong>save_option</strong> (<em>bool</em>) – Whether to save the interpolated images into tiff files (each
interpolation factor seperately).</p></li>
<li><p><strong>return_option</strong> (<em>bool</em>) – Whether to return the interpolated image series as 3d arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>interp_imstack_lst</strong> – A list of interpolated image series corresponding to the interpolation
factor list.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysofi.finterp.ft_matrix2d">
<code class="sig-prename descclassname">pysofi.finterp.</code><code class="sig-name descname">ft_matrix2d</code><span class="sig-paren">(</span><em class="sig-param">xrange</em>, <em class="sig-param">yrange</em><span class="sig-paren">)</span><a class="headerlink" href="#pysofi.finterp.ft_matrix2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fourier transform matrix for x- and y-dimension.</p>
</dd></dl>

<dl class="function">
<dt id="pysofi.finterp.ift_matrix2d">
<code class="sig-prename descclassname">pysofi.finterp.</code><code class="sig-name descname">ift_matrix2d</code><span class="sig-paren">(</span><em class="sig-param">xrange</em>, <em class="sig-param">yrange</em>, <em class="sig-param">interp_num</em><span class="sig-paren">)</span><a class="headerlink" href="#pysofi.finterp.ift_matrix2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inverse fourier transform matrix without center shift for a
given fold of interpolation for x- and y-dimension. Here we use 2 times
the x-dimension of a frame image for xrange and 2 times of y for yrange.
interp_num is the number of times the resolution enhanced. For instance,
when interp_num = 2, the resolution is two times the original one.</p>
</dd></dl>

<dl class="function">
<dt id="pysofi.finterp.interpolate_image">
<code class="sig-prename descclassname">pysofi.finterp.</code><code class="sig-name descname">interpolate_image</code><span class="sig-paren">(</span><em class="sig-param">im</em>, <em class="sig-param">fx</em>, <em class="sig-param">fy</em>, <em class="sig-param">ifx</em>, <em class="sig-param">ify</em>, <em class="sig-param">interp_num</em><span class="sig-paren">)</span><a class="headerlink" href="#pysofi.finterp.interpolate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs fourier interpolation to increase the resolution of the image.
The interpolated image can be further processed by SOFI for
super-resolution imaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>ndarray</em>) – Input image.</p></li>
<li><p><strong>fx</strong> (<em>ndarray</em>) – Fourier transform matrix in x generated from ft_matrix2d function.</p></li>
<li><p><strong>fy</strong> (<em>ndarray</em>) – Fourier transform matrix in y generated from ft_matrix2d function.</p></li>
<li><p><strong>ifx</strong> (<em>ndarray</em>) – Inverse fourier transform matrix in x from ift_matrix2d function.</p></li>
<li><p><strong>ify</strong> (<em>ndarray</em>) – Inverse fourier transform matrix in y from ift_matrix2d function.</p></li>
<li><p><strong>interp_num</strong> (<em>int</em>) – The number of pixels to be interpolated between two adjacent pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>interp_im</strong> – Interpolated image with new dimensions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Please note here that interpolation doesn’ extend over the edgeo f the
matrix, therefore the total number of pixels in the resulting matrix is
not an integer fold of the original size of the matrix. For example, if
the original matrix size of each frame is xdim and ydim for x and y
dimensions respectively. After interpolation, the size of the resulting
matrix will be ((xdim-1)*f + 1) for x dimension, and ((ydim-1)*f + 1)
for y dimension.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">xdim</span><span class="p">,</span> <span class="n">ydim</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xdim</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xdim</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">xrange</span><span class="p">,</span> <span class="n">yrange</span><span class="p">,</span> <span class="n">interp_num</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xdim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ydim</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">fx</span><span class="p">,</span> <span class="n">fy</span> <span class="o">=</span> <span class="n">ft_matrix2d</span><span class="p">(</span><span class="n">xrange</span><span class="p">,</span> <span class="n">yrange</span><span class="p">)</span>
<span class="n">ifx</span><span class="p">,</span> <span class="n">ify</span> <span class="o">=</span> <span class="n">ift_matrix2d</span><span class="p">(</span><span class="n">xrange</span><span class="p">,</span> <span class="n">yrange</span><span class="p">,</span> <span class="n">interp_num</span><span class="p">)</span>
<span class="n">interp_im</span> <span class="o">=</span> <span class="n">interpolate_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ifx</span><span class="p">,</span> <span class="n">ify</span><span class="p">,</span> <span class="n">interp_num</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>To interpolate a single image and generate two images with different interpolation factors (4 and 6):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">im_lst</span> <span class="o">=</span> <span class="n">finterp</span><span class="o">.</span><span class="n">fourier_interp_array</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>To insert seven new pixels between adjacent physical pixels for the first 1000 frames of the input video
and save the interpolated images in a new tiff video.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">finterp</span><span class="o">.</span><span class="n">fourier_interp_tiff</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">interp_num_lst</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">frames</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>
                            <span class="n">save_option</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_option</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="manual.html">Reference manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="manual.html#introduction">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="manual.html#modules">Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="data_class.html"
                        title="previous chapter">The “PysofiData()” class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reconstruction.html"
                        title="next chapter">Reconstruction Options</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/finterp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reconstruction.html" title="Reconstruction Options"
             >next</a> |</li>
        <li class="right" >
          <a href="data_class.html" title="The “PysofiData()” class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysofi 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="manual.html" >PySOFI Reference Manual</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Yuting Miao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>