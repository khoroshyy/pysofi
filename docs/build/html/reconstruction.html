
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Reconstruction Options &#8212; pysofi 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Noise Filtration" href="filter.html" />
    <link rel="prev" title="Fourier Interpolation Module" href="finterp.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="filter.html" title="Noise Filtration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="finterp.html" title="Fourier Interpolation Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysofi 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="manual.html" accesskey="U">pysofi Reference Manual</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="reconstruction-options">
<h1>Reconstruction Options<a class="headerlink" href="#reconstruction-options" title="Permalink to this headline">¶</a></h1>
<p>This module provides multiple image processing and reconstruction options. For instance,
calculate the average image, calculate one moment-reconstructed image of a defined order,
calculate all moment-reconstructed or cumulant reconstructed images to the user-defined
highest order, calculate average moment or cumulant reconstructions over multiple user-
defind blocks, with or without Fourier interpolation or bleaching correction.</p>
<div class="section" id="module-functions.reconstruction">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-functions.reconstruction" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="functions.reconstruction.average_image">
<code class="descclassname">functions.reconstruction.</code><code class="descname">average_image</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>frames=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.average_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the average image for a video file (tiff stack), either for the
whole video or for user defined frames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>frames</strong> (<em>list of int</em><em>, </em><em>optional</em>) – Start and end frame number if not the whole video is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mean_im</strong> – The average image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.average_image_with_finterp">
<code class="descclassname">functions.reconstruction.</code><code class="descname">average_image_with_finterp</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>interp_num</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.average_image_with_finterp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the average image with fourier interpolation for a video file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>interp_num</strong> (<em>int</em>) – Interpolation factor.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>mean_im</strong> (<em>ndarray</em>) – The average image after fourier interpolation. Interpolated</li>
<li><em>images can be further used for SOFI processing.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.block_ave_cumulants">
<code class="descclassname">functions.reconstruction.</code><code class="descname">block_ave_cumulants</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>highest_order</em>, <em>smooth_kernel=251</em>, <em>fbc=0.04</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.block_ave_cumulants" title="Permalink to this definition">¶</a></dt>
<dd><p>Get average cumulant-reconstructed images of all blocks determined by
user-defined noise filtering and bleaching correction factor (fbc).</p>
<p>Within each block, the amount of signal decrease is identical. This
amount of signal decrease is characterized by the bleaching correction
factor, fbc, which is the fractional signal decrease within each block
(as compared to the total signal decrease over the whole signal plot).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>highest_order</strong> (<em>int</em>) – The highest order number of moment-reconstructed images.</li>
<li><strong>smooth_kernel</strong> (<em>int</em>) – The size of the median filter (‘filtering.med_smooth’) window.</li>
<li><strong>fbc</strong> (<em>float</em>) – The fraction of signal decrease within each block compared to the
total signal decrease.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ave_k_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of avereage cumulant-reconstructed images of all blocks.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For more information on noise filtering and bleaching corrextion, please
see appendix 3 of [1].</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><ol class="first last upperalpha simple" start="24">
<li>Yi, and S. Weiss. “Cusp-artifacts in high order superresolution</li>
</ol>
</td></tr>
</tbody>
</table>
<p>optical fluctuation imaging.” bioRxiv: 545574 (2019).</p>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.block_ave_moments">
<code class="descclassname">functions.reconstruction.</code><code class="descname">block_ave_moments</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>highest_order</em>, <em>smooth_kernel=251</em>, <em>fbc=0.04</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.block_ave_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get average moment-reconstructed images of all blocks determined by
user-defined noise filtering and bleaching correction factor (fbc).
Similar to ‘block_ave_cumulants’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>highest_order</strong> (<em>int</em>) – The highest order number of moment-reconstructed images.</li>
<li><strong>smooth_kernel</strong> (<em>int</em>) – The size of the median filter (‘filtering.med_smooth’) window.</li>
<li><strong>fbc</strong> (<em>float</em>) – The fraction of signal decrease within each block compared to the
total signal decrease.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ave_m_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of avereage moment-reconstructed images of all blocks.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_block_moments">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_block_moments</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>highest_order</em>, <em>frames=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_block_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get moment-reconstructed images for user-defined frames (block) of
a video file(tiff stack).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>highest_order</strong> (<em>int</em>) – The highest order number of moment-reconstructed images.</li>
<li><strong>frames</strong> (<em>list of int</em>) – Start and end frame number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of calcualted moment-reconstructed images.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Similar to ‘calc_moments’. Here we omit previously calculated m_set
and mean_im as inputs since a block usually has much fewer number of
frames and takes shorter calculation time.</p>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_cumulants_from_moments">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_cumulants_from_moments</code><span class="sig-paren">(</span><em>moment_set</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_cumulants_from_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate cumulant-reconstructed images from moment-reconstructed images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>moment_set</strong> (<em>dict</em>) – order number (int) -&gt; image (ndarray)
A dictionary of calcualted moment-reconstructed images.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>k_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of calcualted cumulant-reconstructed images.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_cumulants_from_moments_with_lag">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_cumulants_from_moments_with_lag</code><span class="sig-paren">(</span><em>m_set</em>, <em>tauSeries</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_cumulants_from_moments_with_lag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate cumulant-reconstructed images from moment-reconstructed images
with time lags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>m_set</strong> (<em>dict</em>) – order (int) -&gt; dict (partition (tuple) -&gt; image (ndarray))
A nested dictionary of moment-reconstructions of all partitions that
calculated from ‘calc_moments_with_lag’.</li>
<li><strong>tauSeries</strong> (<em>list of int</em>) – A list of time lags for frames contribute to moment reconstruction.
The first element is recommended to be 0, and there should be seven
elements in the list. The values should be the same as the input for
‘calc_moments_with_lag’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>k_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of calcualted cumulant-reconstructed images with time
lags.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_moment_im">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_moment_im</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>order</em>, <em>frames=[]</em>, <em>mean_im=None</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_moment_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Get one moment-reconstructed image of a defined order for a video file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>order</strong> (<em>int</em>) – The order number of moment-reconstructed image.</li>
<li><strong>frames</strong> (<em>list of int</em>) – The start and end frame number.</li>
<li><strong>mean_im</strong> (<em>ndarray</em>) – Average image of the tiff stack.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>moment_im</strong> – The moments-reconstructed image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_moments">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_moments</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>highest_order</em>, <em>frames=[]</em>, <em>m_set={}</em>, <em>mean_im=None</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all moment-reconstructed images to the user-defined highest order for
a video file(tiff stack).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>highest_order</strong> (<em>int</em>) – The highest order number of moment-reconstructed images.</li>
<li><strong>frames</strong> (<em>list of int</em>) – The start and end frame number.</li>
<li><strong>m_set</strong> (<em>dict</em>) – order number (int) -&gt; image (ndarray)
A dictionary of previously calcualted moment-reconstructed images.</li>
<li><strong>mean_im</strong> (<em>ndarray</em>) – Average image of the tiff stack.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m_set</strong> – order number (int) -&gt; image (ndarray)
A dictionary of calcualted moment-reconstructed images.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_moments_with_lag">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_moments_with_lag</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>tauSeries</em>, <em>frames=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_moments_with_lag" title="Permalink to this definition">¶</a></dt>
<dd><p>Get moment-reconnstructed images with defined time lags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>tauSeries</strong> (<em>list of int</em>) – A list of time lags for frames contribute to moment reconstruction.
The first element is recommended to be 0, and there should seven
elements in the list.</li>
<li><strong>frames</strong> (<em>list of int</em>) – The start and end frame number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m_set</strong> – order (int) -&gt; dict (partition (tuple) -&gt; image (ndarray))
A nested dictionary of moment-reconstructions of all partitions.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_total_signal">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_total_signal</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_total_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total signal intensity of each frame for the whole
video (tiff stack).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>total_signal</strong> – Signal intensity of each frame ordered by the frame number.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1darray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.calc_xc_im">
<code class="descclassname">functions.reconstruction.</code><code class="descname">calc_xc_im</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>ri_range</em>, <em>frames=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.calc_xc_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cross-cumulant image with different pixel combinations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>ri_range</strong> (<em>int</em>) – Maximium distance (# pixels) between the original the selected pixel.</li>
<li><strong>frames</strong> (<em>list of int</em>) – The start and end frame number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>xc</strong> – pixel (tuple) -&gt; image (ndarray)
A dictionary of reconstructed images with pixel index as keys.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.correct_bleaching">
<code class="descclassname">functions.reconstruction.</code><code class="descname">correct_bleaching</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>fbc=0.04</em>, <em>smooth_kernel=251</em>, <em>save_option=True</em>, <em>return_option=False</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.correct_bleaching" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bleaching correction on a tiff image (stack).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fbc</strong> (<em>float</em>) – The fraction of signal decrease within each block compared
to the total signal decrease. Only used when bleach correction
is True.</li>
<li><strong>smooth_kernel</strong> (<em>int</em>) – The size of the median filter window.</li>
<li><strong>save_option</strong> (<em>bool</em>) – Whether to save the corrected images into tiff files.</li>
<li><strong>return_option</strong> (<em>bool</em>) – Whether to return the corrected image series as a 3d array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>bc_im</strong> – All bleaching-corrected imagee in a 3d array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.cumulants_all_blocks">
<code class="descclassname">functions.reconstruction.</code><code class="descname">cumulants_all_blocks</code><span class="sig-paren">(</span><em>m_set_all_blocks</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.cumulants_all_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate cumulant-reconstructed images from moment-reconstructed images
of each block. Similar to ‘calc_cumulants_from_moments’.</p>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.cut_frames">
<code class="descclassname">functions.reconstruction.</code><code class="descname">cut_frames</code><span class="sig-paren">(</span><em>signal_level</em>, <em>fbc=0.04</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.cut_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the list of frame number to cut the whole signal plot into seperate
blocks based on the change of total signal intensity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>signal_level</strong> (<em>1darray</em>) – Signal change over time (can be derived from ‘calc_total_signal’).</li>
<li><strong>fbc</strong> (<em>float</em>) – The fraction of signal decrease within each block compared to the
total signal decrease.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>bounds</strong> (<em>list of int</em>) – Signal intensities on the boundary of each block.</li>
<li><strong>frame_lst</strong> (<em>list of int</em>) – Frame number where to cut the whole signal plot into blocks.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The number of blocks is the inverse of the bleaching correction factor,
fbc. For instance, if fbc=0.04, it means that in each block, the
decrease in signal intensity is 4% if the total decrease, and the whole
plot / video is cut into 25 blocks. For some data, it is possible that
the maximun signal intensity does not appear at the beginning of the
signal plot. Here, we consider all frames before the maximum in the
same block as the maximum frame / intensity since usually the number
of frames is not too large. The user can add in extra blocks if the
initial intensity is much smaller than the maximum.</p>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.min_image">
<code class="descclassname">functions.reconstruction.</code><code class="descname">min_image</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>frames=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.min_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the minimum image for a video file (tiff stack), either for the
whole video or for user defined frames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>frames</strong> (<em>list of int</em><em>, </em><em>optional</em>) – Start and end frame number if not the whole video is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>min_im</strong> – The minimum image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.moment_im_with_finterp">
<code class="descclassname">functions.reconstruction.</code><code class="descname">moment_im_with_finterp</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>order</em>, <em>interp_num</em>, <em>frames=[]</em>, <em>mean_im=None</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.moment_im_with_finterp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get one moment-reconstructed image of a defined order for a video file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>order</strong> (<em>int</em>) – The order number of moment-reconstructed image.</li>
<li><strong>interp_num</strong> (<em>int</em>) – The interpolation factor.</li>
<li><strong>mvlength</strong> (<em>int</em>) – The length of video for the reconstruction.</li>
<li><strong>mean_im</strong> (<em>ndarray</em>) – Average image of the tiff stack.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>moment_im</strong> – The moments-reconstructed image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.reconstruction.moments_all_blocks">
<code class="descclassname">functions.reconstruction.</code><code class="descname">moments_all_blocks</code><span class="sig-paren">(</span><em>filepath</em>, <em>filename</em>, <em>highest_order</em>, <em>smooth_kernel=251</em>, <em>fbc=0.04</em><span class="sig-paren">)</span><a class="headerlink" href="#functions.reconstruction.moments_all_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get moment-reconstructed images for seperate blocks with user-defined
noise filtering and bleaching correction factor (fbc).</p>
<p>Within each block, the amount of signal decrease is identical. This
amount of signal decrease is characterized by the bleaching correction
factor, fbc, which is the fractional signal decrease within each block
(as compared to the total signal decrease over the whole signal plot).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>str</em>) – Path to the tiff file.</li>
<li><strong>filename</strong> (<em>str</em>) – Name of the tiff file.</li>
<li><strong>highest_order</strong> (<em>int</em>) – The highest order number of moment-reconstructed images.</li>
<li><strong>smooth_kernel</strong> (<em>int</em>) – The size of the median filter (‘filtering.med_smooth’) window.</li>
<li><strong>fbc</strong> (<em>float</em>) – The fraction of signal decrease within each block compared to the
total signal decrease.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m_set_all_blocks</strong> – block_number (int) -&gt; {order number (int) -&gt; image (ndarray)}
A dictionary of moment-reconstructed images of each block.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Similar to ‘calc_moments’. Here we omit previously calculated m_set
and mean_im as inputs since a block usually has much fewer number of
frames and takes shorter calculation time.</p>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>To calculate fourth-order moment-reconstructed image using frame 50 to 100 of the input video
with FOurier interpolation (factor=2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m_im</span> <span class="o">=</span> <span class="n">reconstruction</span><span class="o">.</span><span class="n">moment_im_with_finterp</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">interp_num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p>To calculate up to the fourth-order cumulant-reconstructed image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m_set</span> <span class="o">=</span> <span class="n">reconstruction</span><span class="o">.</span><span class="n">calc_moments</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">highest_order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">k_set</span> <span class="o">=</span> <span class="n">reconstruction</span><span class="o">.</span><span class="n">calc_cumulants_from_moments</span><span class="p">(</span><span class="n">m_set</span><span class="p">)</span>
</pre></div>
</div>
<p>To calculate the average moment reconstruction by dividing the whol video into 25 blocks, and in each block the
signal decrease is 4% of the total signal decrease:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_mim</span> <span class="o">=</span> <span class="n">reconstruction</span><span class="o">.</span><span class="n">block_ave_moments</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">smooth_kernel</span><span class="o">=</span><span class="mi">251</span><span class="p">,</span> <span class="n">fbc</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
</pre></div>
</div>
<p>To perform bleaching correction on a input video and save the corrected images in a new tiff file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reconstruction</span><span class="o">.</span><span class="n">correct_bleaching</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fbc</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">smooth_kernel</span><span class="o">=</span><span class="mi">251</span><span class="p">,</span>
                                 <span class="n">save_option</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_option</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Demos</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nbviewer.jupyter.org/github/xiyuyi-at-LLNL/pysofi/blob/master/Notebooks/E13_PysofiExample_LiveCellActinFilaments.ipynb">SOFI 2.0 Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="manual.html">Reference manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="manual.html#introduction">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="manual.html#modules">Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="finterp.html"
                        title="previous chapter">Fourier Interpolation Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="filter.html"
                        title="next chapter">Noise Filtration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/reconstruction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="filter.html" title="Noise Filtration"
             >next</a> |</li>
        <li class="right" >
          <a href="finterp.html" title="Fourier Interpolation Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysofi 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="manual.html" >pysofi Reference Manual</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Yuting Miao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>